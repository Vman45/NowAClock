<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>This device is now a clock.</title>
    <style>
      body {
          font-family: 'Noto Sans', sans-serif;
          text-align: center;
          background-color: black;
          color: white;
      }
      img {
          max-width: 100%;
          max-height: 100%;
      }
      #date {
          font-size: 4em;
          display: flex;
          justify-content: center;
      }
      #time {
          font-size: 6em;
          font-weight: bold;
          display: flex;
          justify-content: center;
      }
      #astro {
          display: flex;
          justify-content: center;
          align-items: center;
          margin: auto;
          width: 50vmin;
          height: 50vmin;
      }
    </style>
  </head>
  <body onload='initialize()'>
    <div id='date'>
    </div>
    <div id='time'>
    </div>
    <div id='astro'>
    </div>
    <script src='suncalc/suncalc.js' type='text/javascript'>
    </script>
    <script>
      function moonPhase(date) {
          var moonIllum = SunCalc.getMoonIllumination(date);
          var phasePercent = (moonIllum.phase * 100).toFixed(0) + '%'
          var phaseImg = (moonIllum.phase * 16).toFixed(0) % 16
          phaseImg = phaseImg.toString().padStart(2, 0);
          return phasePercent + '<img src="MoonPhases/moon' + phaseImg + '.jpg">'
      }
      function startTime() {
        var now = new Date();
        document.getElementById('time').innerHTML =
          now.toLocaleTimeString([], {hour12: true,
                                      hour: 'numeric',
                                      minute: 'numeric'});
        document.getElementById('date').innerHTML =
          now.toLocaleDateString([], {weekday: 'long',
                                      month: 'long',
                                      day: 'numeric'}).replace(',', '');
        document.getElementById('astro').innerHTML = moonPhase(now);
        now = new Date();
        var next_minute = (60 - now.getSeconds()) * 1000 - now.getMilliseconds();
        setTimeout(startTime, next_minute);
      }
      function initialize() {
          startTime();
      }
    </script>
  </body>
</html>
